import{a as Ne,c as he,j as e,b as G,r as i,R as ke}from"./index-d84rcWRm.js";const Se=()=>{const r=new URLSearchParams(window.location.search).get("token");if(r)return r;try{return localStorage.getItem("clientToken")||""}catch{return""}},me=s=>{try{localStorage.setItem("clientToken",s)}catch{}},Ce=()=>{try{localStorage.removeItem("clientToken")}catch{}};async function B(s){try{const r=await s.json();return(r==null?void 0:r.error)||(r==null?void 0:r.message)||`${s.status}`}catch{return`${s.status} ${s.statusText}`}}const F=(s,r,v,l={})=>{const x=Object.assign({},{maxWidth:"640px",align:"center",radius:"14px",shadow:"true",border:"true",width:"100%",height:"460px"},l);return`<script ${["async",'src="https://before-after-embed.vercel.app/embed.js"',`data-embed-id="${s||"your-embed-id"}"`,`data-theme="${v}"`,`data-variant="${r}"`,`data-max-width="${x.maxWidth}"`,`data-align="${x.align}"`,`data-radius="${x.radius}"`,`data-shadow="${x.shadow}"`,`data-border="${x.border}"`,`data-width="${x.width}"`,`data-height="${x.height}"`].join(" ")}><\/script>`},$e=({className:s="",children:r})=>e.jsx("div",{className:`mx-auto w-full max-w-6xl px-4 sm:px-6 ${s}`,children:r}),L=({title:s,children:r})=>e.jsxs("section",{className:"rounded-2xl border border-white/10 bg-white/5 p-4 sm:p-6",children:[s&&e.jsx("h2",{className:"text-base font-semibold",children:s}),e.jsx("div",{className:s?"mt-3":"",children:r})]}),c=({variant:s="primary",className:r="",children:v,...l})=>{const m="inline-flex items-center justify-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition",x={primary:"text-white bg-gradient-to-r from-violet-600 via-pink-500 to-cyan-400 hover:opacity-90 disabled:opacity-60",outline:"border border-white/20 bg-transparent text-white hover:bg-white/10",subtle:"bg-white/10 text-white hover:bg-white/20"};return e.jsx("button",{className:`${m} ${x[s]} ${r}`,...l,children:v})},f=s=>e.jsx("input",{...s,className:"w-full rounded-md border border-white/20 bg-neutral-900 p-2 text-sm text-white placeholder-white/50 focus:ring-2 focus:ring-violet-500"}),g=({children:s,...r})=>e.jsx("select",{...r,className:"w-full rounded-md border border-white/20 bg-neutral-900 p-2 text-sm text-white focus:ring-2 focus:ring-violet-500",children:s}),Te=({children:s})=>e.jsx("code",{className:"rounded-md bg-black/40 px-1.5 py-0.5 text-[12px]",children:s}),U=({children:s})=>e.jsx("span",{className:"text-xs font-medium text-white/70",children:s});function Ee(){const[s,r]=i.useState("");return i.useEffect(()=>{const l=new URLSearchParams(window.location.search),m=l.get("token")||Se();m&&(r(m),me(m),l.get("token")&&(l.delete("token"),window.history.replaceState({},"",window.location.pathname)))},[]),[s,l=>{r(l||""),l?me(l):Ce()}]}function Pe(){const[s,r]=i.useState(""),[v,l]=i.useState(!1),[m,x]=i.useState(""),[C,b]=i.useState(""),E=async w=>{w.preventDefault(),l(!0),x(""),b("");try{const h=await fetch("/api/client/me",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s})});if(!h.ok)throw new Error(await B(h));const j=await h.json();if(j!=null&&j.link)window.location.href=j.link;else if(j!=null&&j.token){const $=new URL(window.location.href);$.searchParams.set("token",j.token),window.location.replace($.toString())}else b("Sign-in link sent. Check your email.")}catch(h){x(typeof(h==null?void 0:h.message)=="string"?h.message:"Failed to send sign-in link")}finally{l(!1)}};return e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-neutral-950 text-white",children:e.jsxs("form",{onSubmit:E,className:"w-full max-w-sm rounded-xl border border-white/10 bg-white/5 p-6",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Client Portal Sign In"}),e.jsx(f,{type:"email",placeholder:"you@example.com",value:s,onChange:w=>r(w.target.value),required:!0}),e.jsx(c,{type:"submit",className:"mt-4 w-full",disabled:v,children:v?"Sending…":"Send sign-in link"}),!!m&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:m}),!!C&&e.jsx("p",{className:"mt-2 text-sm text-white/70",children:C})]})})}function Re({token:s,onSignOut:r}){var de,ce,oe;const[v,l]=i.useState(null),[m,x]=i.useState([]),[C,b]=i.useState(!0),[E,w]=i.useState(""),[h,j]=i.useState({id:"",vertical:"barber",theme:"dark"}),[$,J]=i.useState(""),[O,I]=i.useState("compact"),[_,pe]=i.useState("dark"),[k,D]=i.useState({maxWidth:"640px",align:"center",radius:"14px",shadow:"true",border:"true",width:"100%",height:"460px"}),A=i.useMemo(()=>F($,O,_,k),[$,O,_,k]),[z,H]=i.useState(""),q=ke.useRef(null);i.useEffect(()=>{H(A)},[A]);const Z=t=>{var a;try{const n=q.current;if(!n)return;const d=n.contentDocument||((a=n.contentWindow)==null?void 0:a.document);if(!d)return;const p=`<!doctype html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/></head><body style="margin:0;background:${V};color:#e6eaf2;font-family:Inter,ui-sans-serif,system-ui;display:flex;justify-content:${k.align==="center"?"center":"flex-start"};padding:16px">${t}</body></html>`;d.open(),d.write(p),d.close()}catch{}},[V,ge]=i.useState("#0b0d10"),[K,Q]=i.useState("");i.useEffect(()=>{const t=setTimeout(()=>{try{Z(z),Q("")}catch{Q("Failed to render preview")}},300);return()=>clearTimeout(t)},[z,V,k.align]);const[W,X]=i.useState(""),[Y,ee]=i.useState([]),[te,ae]=i.useState(!1),[o,se]=i.useState(null),[ie,ne]=i.useState(!1),[S,T]=i.useState(null),[ve,re]=i.useState(!1),[y,je]=i.useState(null),[be,M]=i.useState(!1),[u,N]=i.useState({id:"",name:"",vertical:"barber",theme:"dark",width:"100%",height:"520px",variant:"card",radius:"12px",shadow:"true",border:"true"}),P=async()=>{try{b(!0),w("");const t=await fetch("/api/client/me",{headers:{Authorization:`Bearer ${s}`}});if(!t.ok)throw new Error("Auth failed");const a=await t.json();l((a==null?void 0:a.client)||a);const n=await fetch("/api/client/embeds",{headers:{Authorization:`Bearer ${s}`}});if(!n.ok)throw new Error(await B(n));const d=await n.json(),p=Array.isArray(d)?d:(d==null?void 0:d.embeds)||[];x(p);try{const R=await(await fetch("/api/client/settings",{headers:{Authorization:`Bearer ${s}`}})).json();T((R==null?void 0:R.settings)||{}),je((R==null?void 0:R.plan)||null)}catch{}!$&&p.length&&J(p[0].id),!W&&p.length&&X(p[0].id)}catch{w("Failed to load data")}finally{b(!1)}};i.useEffect(()=>{P()},[s]),i.useEffect(()=>{(async()=>{try{const t=new URLSearchParams(window.location.search),a=t.get("nextPlan");if(!a)return;t.delete("nextPlan");const n=new URL(window.location.href);n.search=t.toString(),window.history.replaceState({},"",n.toString());const d=await fetch("/api/billing/checkout",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({planId:a})}),p=await d.json();if(!d.ok)throw new Error((p==null?void 0:p.error)||"Checkout failed");p!=null&&p.url&&(window.location.href=p.url)}catch{}})()},[s]);const fe=async t=>{t.preventDefault();try{const a=await fetch("/api/client/embeds",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(h)});if(!a.ok)throw new Error(await B(a));j({id:"",vertical:h.vertical,theme:h.theme}),P()}catch(a){w(typeof(a==null?void 0:a.message)=="string"?a.message:"Failed to create embed")}},we=async(t,a)=>{try{const n=await fetch("/api/client/embeds",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({id:t,theme:a})});if(!n.ok)throw new Error(await B(n));P()}catch(n){w(typeof(n==null?void 0:n.message)=="string"?n.message:"Failed to update embed")}},le=async t=>{if(t){ae(!0);try{const a=await fetch(`/api/client/usage?embedId=${encodeURIComponent(t)}`,{headers:{Authorization:`Bearer ${s}`}});if(!a.ok)throw new Error(await B(a));const n=await a.json(),d=Array.isArray(n)?n:(n==null?void 0:n.events)||[];ee(d)}catch{ee([])}finally{ae(!1)}}},ye=async()=>{ne(!0);try{const t=await fetch("/api/client/stats",{headers:{Authorization:`Bearer ${s}`}});if(!t.ok)throw new Error(await B(t));const a=await t.json();se(a||null)}catch{se(null)}finally{ne(!1)}};return C?e.jsx("div",{className:"p-6 text-white",children:"Loading…"}):E?e.jsx("div",{className:"p-6 text-red-400",children:E}):e.jsxs("div",{className:"min-h-screen bg-neutral-950 text-white",children:[e.jsx("header",{className:"sticky top-0 z-10 border-b border-white/10 bg-neutral-950/80 backdrop-blur",children:e.jsxs($e,{className:"flex h-14 items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"grid h-8 w-8 place-items-center rounded-xl bg-gradient-to-tr from-violet-500 via-pink-500 to-cyan-400 shadow",children:e.jsx("span",{className:"text-xs font-bold",children:"B/A"})}),e.jsx("div",{className:"text-sm font-semibold",children:"Before/After Portal"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[v&&e.jsxs("span",{children:[v.name," (",e.jsx(Te,{children:v.id}),")"]}),e.jsx(c,{variant:"outline",onClick:r,children:"Sign out"})]})]})}),e.jsxs("main",{className:"mx-auto max-w-6xl space-y-8 p-4",children:[e.jsxs(L,{title:"Embeds",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between rounded-md border border-white/10 bg-black/30 p-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"opacity-70",children:"Current plan"}),e.jsx("div",{className:"font-medium",children:(y==null?void 0:y.name)||(y==null?void 0:y.id)||"free"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-xs opacity-70",children:[(y==null?void 0:y.monthlyGenerations)??0," gens / mo"]}),e.jsx("a",{href:"/app/pricing.html",className:"underline",children:"Change plan"})]})]}),e.jsx("ul",{className:"space-y-2 text-sm",children:m.map(t=>e.jsxs("li",{className:"flex flex-col gap-2 rounded-md border border-white/10 bg-black/20 p-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"truncate",children:[t.id," – ",t.vertical," – ",t.theme]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(g,{value:t.theme,onChange:a=>we(t.id,a.target.value),children:[e.jsx("option",{value:"dark",children:"dark"}),e.jsx("option",{value:"light",children:"light"})]}),e.jsx(c,{variant:"subtle",onClick:()=>J(t.id),children:"Use in Snippet"}),e.jsx(c,{variant:"outline",onClick:()=>navigator.clipboard.writeText(F(t.id,O,t.theme)),children:"Copy Snippet"}),e.jsx("a",{className:"text-xs underline",target:"_blank",rel:"noreferrer",href:`/widget.html?embedId=${encodeURIComponent(t.id)}&theme=${encodeURIComponent(t.theme)}`,children:"Open"}),e.jsx(c,{variant:"outline",onClick:()=>{N({...t,variant:t.variant||"card",radius:t.radius||"12px",shadow:t.shadow??"true",border:t.border??"true"}),M(!0)},children:"Edit"}),e.jsx(c,{variant:"outline",onClick:async()=>{const a=`${t.id}-copy`;await fetch("/api/client/embeds",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({...t,id:a,name:t.name||a})}),P()},children:"Duplicate"}),e.jsx(c,{variant:"outline",onClick:async()=>{if(!confirm(`Delete embed ${t.id}?`))return;const a=new URL("/api/client/embeds",location.origin);a.searchParams.set("id",t.id),await fetch(a.toString(),{method:"DELETE",headers:{Authorization:`Bearer ${s}`}}),P()},children:"Delete"})]})]},t.id))}),e.jsxs("form",{onSubmit:fe,className:"mt-4 grid gap-2 md:grid-cols-4",children:[e.jsx(f,{placeholder:"id",value:h.id,onChange:t=>j({...h,id:t.target.value}),required:!0}),e.jsxs(g,{value:h.vertical,onChange:t=>j({...h,vertical:t.target.value}),children:[e.jsx("option",{value:"barber",children:"barber"}),e.jsx("option",{value:"dental",children:"dental"}),e.jsx("option",{value:"detailing",children:"detailing"}),e.jsx("option",{value:"cosmetics",children:"cosmetics"}),e.jsx("option",{value:"custom",children:"custom"})]}),e.jsxs(g,{value:h.theme,onChange:t=>j({...h,theme:t.target.value}),children:[e.jsx("option",{value:"dark",children:"dark"}),e.jsx("option",{value:"light",children:"light"})]}),e.jsx(c,{type:"submit",className:"md:col-span-4",children:"Create"})]})]}),e.jsx(L,{title:"Client settings",children:S?e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"grid gap-1",children:[e.jsx(U,{children:"Display name"}),e.jsx(f,{value:S.displayName||"",onChange:t=>T(a=>({...a,displayName:t.target.value}))})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx(U,{children:"Brand color"}),e.jsx(f,{value:S.brandColor||"#7c3aed",onChange:t=>T(a=>({...a,brandColor:t.target.value}))})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx(U,{children:"Default theme"}),e.jsxs(g,{value:S.defaultTheme||"dark",onChange:t=>T(a=>({...a,defaultTheme:t.target.value})),children:[e.jsx("option",{value:"dark",children:"dark"}),e.jsx("option",{value:"light",children:"light"})]})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx(U,{children:"Default variant"}),e.jsxs(g,{value:S.defaultVariant||"card",onChange:t=>T(a=>({...a,defaultVariant:t.target.value})),children:[e.jsx("option",{value:"compact",children:"compact"}),e.jsx("option",{value:"card",children:"card"})]})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx(U,{children:"Powered by"}),e.jsxs(g,{value:S.poweredBy||"false",onChange:t=>T(a=>({...a,poweredBy:t.target.value})),children:[e.jsx("option",{value:"false",children:"hidden"}),e.jsx("option",{value:"true",children:"show"})]})]}),e.jsxs("div",{className:"grid gap-1 md:col-span-2",children:[e.jsx(U,{children:"Webhook URL (optional)"}),e.jsx(f,{placeholder:"https://example.com/webhook",value:S.webhookUrl||"",onChange:t=>T(a=>({...a,webhookUrl:t.target.value}))})]}),e.jsx("div",{className:"md:col-span-2 flex gap-2 justify-end",children:e.jsx(c,{disabled:ve,onClick:async()=>{re(!0);try{await fetch("/api/client/settings",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(S)})}finally{re(!1)}},children:"Save settings"})})]}):e.jsx("div",{className:"text-sm opacity-70",children:"Loading…"})}),be&&e.jsx("div",{className:"fixed inset-0 z-50 grid place-items-center bg-black/50 p-4",children:e.jsxs("div",{className:"w-full max-w-xl rounded-xl border border-white/10 bg-neutral-950 p-4 text-white",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("div",{className:"text-lg font-semibold",children:"Edit embed"}),e.jsx("button",{className:"text-white/70",onClick:()=>M(!1),children:"✕"})]}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-white/70",children:"ID"}),e.jsx(f,{value:u.id,disabled:!0})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-white/70",children:"Name"}),e.jsx(f,{value:u.name||"",onChange:t=>N(a=>({...a,name:t.target.value}))})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-white/70",children:"Vertical"}),e.jsxs(g,{value:u.vertical,onChange:t=>N(a=>({...a,vertical:t.target.value})),children:[e.jsx("option",{value:"barber",children:"barber"}),e.jsx("option",{value:"dental",children:"dental"}),e.jsx("option",{value:"detailing",children:"detailing"}),e.jsx("option",{value:"cosmetics",children:"cosmetics"}),e.jsx("option",{value:"custom",children:"custom"})]})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-white/70",children:"Variant"}),e.jsxs(g,{value:u.variant,onChange:t=>N(a=>({...a,variant:t.target.value})),children:[e.jsx("option",{value:"compact",children:"compact"}),e.jsx("option",{value:"card",children:"card"})]})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-white/70",children:"Width"}),e.jsx(f,{value:u.width,onChange:t=>N(a=>({...a,width:t.target.value}))})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-white/70",children:"Height"}),e.jsx(f,{value:u.height,onChange:t=>N(a=>({...a,height:t.target.value}))})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-white/70",children:"Radius"}),e.jsx(f,{value:u.radius,onChange:t=>N(a=>({...a,radius:t.target.value}))})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-white/70",children:"Border"}),e.jsxs(g,{value:u.border,onChange:t=>N(a=>({...a,border:t.target.value})),children:[e.jsx("option",{value:"true",children:"true"}),e.jsx("option",{value:"false",children:"false"})]})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-white/70",children:"Shadow"}),e.jsxs(g,{value:u.shadow,onChange:t=>N(a=>({...a,shadow:t.target.value})),children:[e.jsx("option",{value:"true",children:"true"}),e.jsx("option",{value:"false",children:"false"})]})]})]}),e.jsxs("div",{className:"mt-4 grid gap-2 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 text-xs text-white/70",children:"Live preview"}),e.jsx("iframe",{title:"edit-preview",sandbox:"allow-scripts allow-forms allow-same-origin",style:{width:"100%",height:"360px",border:"0",borderRadius:"10px",background:"#0b0d10"},ref:t=>{var d;if(!t)return;const a=F(u.id,u.variant,u.theme||"dark").replace('data-width="100%"','data-width="'+(u.width||"100%")+'"').replace('data-height="460px"','data-height="'+(u.height||"520px")+'"'),n=t.contentDocument||((d=t.contentWindow)==null?void 0:d.document);n&&(n.open(),n.write(`<!doctype html><html><body style="margin:0;background:#0b0d10">${a}</body></html>`),n.close())}})]}),e.jsxs("div",{className:"flex flex-col justify-end gap-2",children:[e.jsx(c,{onClick:async()=>{const t={...u};await fetch("/api/client/embeds",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(t)}),M(!1),P()},children:"Save changes"}),e.jsx(c,{variant:"subtle",onClick:()=>M(!1),children:"Cancel"})]})]})]})}),e.jsxs(L,{title:"Snippet Builder",children:[e.jsxs("div",{className:"grid gap-2 md:grid-cols-3",children:[e.jsx(f,{placeholder:"embedId",value:$,onChange:t=>J(t.target.value)}),e.jsxs(g,{value:O,onChange:t=>I(t.target.value),children:[e.jsx("option",{value:"compact",children:"compact"}),e.jsx("option",{value:"card",children:"card"})]}),e.jsxs(g,{value:_,onChange:t=>pe(t.target.value),children:[e.jsx("option",{value:"dark",children:"dark"}),e.jsx("option",{value:"light",children:"light"})]})]}),e.jsxs("div",{className:"mt-2 grid gap-2 md:grid-cols-3",children:[e.jsx(c,{variant:"subtle",onClick:()=>{I("compact"),D({...k,maxWidth:"640px",align:"center",radius:"14px",width:"100%",height:"460px"})},children:"Preset: Compact"}),e.jsx(c,{variant:"subtle",onClick:()=>{I("card"),D({...k,maxWidth:"980px",align:"left",radius:"12px",width:"100%",height:"520px"})},children:"Preset: Card"}),e.jsx(c,{variant:"subtle",onClick:()=>{I("card"),D({...k,maxWidth:"100%",align:"center",radius:"0px",width:"100%",height:"600px",border:"false",shadow:"false"})},children:"Preset: Full‑bleed"})]}),e.jsx("pre",{className:"mt-4 whitespace-pre-wrap break-words rounded-md bg-black/60 p-2 text-xs",children:A}),e.jsx(c,{className:"mt-2",onClick:()=>navigator.clipboard.writeText(A),children:"Copy snippet"})]}),e.jsx(L,{title:"Live Snippet Preview (iframe sandbox)",children:e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("textarea",{value:z,onChange:t=>H(t.target.value),rows:10,className:"w-full rounded-md border border-white/10 bg-black/40 p-2 text-xs font-mono"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx(c,{variant:"subtle",onClick:()=>H(A),children:"Reset to builder"}),e.jsx(c,{onClick:()=>Z(z),children:"Run preview"}),e.jsxs(g,{value:V,onChange:t=>ge(t.target.value),children:[e.jsx("option",{value:"#0b0d10",children:"dark page"}),e.jsx("option",{value:"#ffffff",children:"white page"}),e.jsx("option",{value:"#f1f5f9",children:"light grey"})]}),e.jsxs(g,{value:k.align,onChange:t=>D(a=>({...a,align:t.target.value})),children:[e.jsx("option",{value:"center",children:"center"}),e.jsx("option",{value:"left",children:"left"})]})]}),!!K&&e.jsx("div",{className:"mt-2 rounded-md border border-red-500/40 bg-red-500/10 p-2 text-xs text-red-300",children:K})]}),e.jsx("div",{className:"rounded-xl border border-white/10 bg-black/20 p-2",children:e.jsx("iframe",{ref:q,title:"snippet-preview",sandbox:"allow-scripts allow-forms allow-same-origin",style:{width:"100%",height:"520px",border:"0",borderRadius:"10px",background:"#0b0d10"}})})]})}),e.jsxs(L,{title:"Usage",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[e.jsx(g,{value:W,onChange:t=>{X(t.target.value),le(t.target.value)},children:m.map(t=>e.jsx("option",{value:t.id,children:t.id},t.id))}),e.jsx(c,{variant:"subtle",onClick:()=>le(W),disabled:!W||te,children:te?"Loading…":"Refresh"})]}),Y.filter(t=>t&&t.event==="client_render").length===0?e.jsx("div",{className:"text-sm text-white/70",children:"No events yet."}):e.jsx("ul",{className:"space-y-1 text-xs",children:[...Y].filter(t=>t&&t.event==="client_render").sort((t,a)=>((a==null?void 0:a.ts)||0)-((t==null?void 0:t.ts)||0)).map(t=>e.jsxs("li",{className:"rounded border border-white/10 bg-black/20 p-2",children:[e.jsx("span",{className:"opacity-80",children:"render"})," · ",e.jsx("span",{className:"opacity-60",children:new Date(t.ts).toLocaleString(void 0,{timeZoneName:"short"})})]},t.id||t.ts))})]}),e.jsxs(L,{title:"Stats & Usage",children:[e.jsx("div",{className:"mb-3 flex items-center gap-2",children:e.jsx(c,{variant:"subtle",onClick:ye,disabled:ie,children:ie?"Loading…":"Refresh stats"})}),o?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-4",children:[e.jsxs("div",{className:"rounded-md border border-white/10 bg-black/20 p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-semibold",children:((de=o==null?void 0:o.totals)==null?void 0:de.overall)??0}),e.jsx("div",{className:"text-xs opacity-70",children:"Total events"})]}),e.jsxs("div",{className:"rounded-md border border-white/10 bg-black/20 p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-semibold",children:((ce=o==null?void 0:o.last24h)==null?void 0:ce.overall)??0}),e.jsx("div",{className:"text-xs opacity-70",children:"Events (24h)"})]}),e.jsxs("div",{className:"rounded-md border border-white/10 bg-black/20 p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-semibold",children:((oe=o==null?void 0:o.plan)==null?void 0:oe.monthlyGenerations)??0}),e.jsx("div",{className:"text-xs opacity-70",children:"Plan gens / mo"})]}),e.jsxs("div",{className:"rounded-md border border-white/10 bg-black/20 p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-semibold",children:(o==null?void 0:o.monthlyUsed)??0}),e.jsx("div",{className:"text-xs opacity-70",children:"Used this month"})]})]}),e.jsx("div",{className:"mt-4 rounded-md border border-white/10 bg-black/30 p-3",children:(()=>{var d;const t=Number((o==null?void 0:o.monthlyUsed)||0),a=Number(((d=o==null?void 0:o.plan)==null?void 0:d.monthlyGenerations)||0),n=a>0?Math.min(100,Math.round(t/a*100)):0;return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-1 flex items-center justify-between text-xs",children:[e.jsx("div",{className:"opacity-80",children:"Monthly generations"}),e.jsxs("div",{className:"opacity-70",children:[t," / ",a]})]}),e.jsx("div",{className:"h-2 w-full overflow-hidden rounded bg-white/10",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-violet-500 via-pink-500 to-cyan-400",style:{width:n+"%"}})}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center justify-between text-xs",children:[e.jsx("div",{className:"opacity-70",children:"$10 per extra 100 gens after limit"}),e.jsx(c,{className:"px-3 py-1",onClick:()=>alert("Top-up coming soon"),children:"Buy top-up"})]})]})})()})]}):e.jsx("div",{className:"text-sm text-white/70",children:"No stats yet."})]})]})]})}function xe(){const[s,r]=Ee();return s?e.jsx(Re,{token:s,onSignOut:()=>{r(""),window.location.href="/app/client.html"}}):e.jsx(Pe,{})}const ue=()=>{const s=document.getElementById("root");s&&(Ne&&typeof he.createRoot=="function"?he.createRoot(s).render(e.jsx(xe,{})):G&&typeof G.render=="function"&&G.render(e.jsx(xe,{}),s))};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",ue,{once:!0}):ue();(function(){if(new URLSearchParams(window.location.search).get("devtest")!=="1")return;const v=[],l=(b,E,w="")=>v.push({name:b,pass:!!E,detail:w}),m=F("abc","compact","dark");l("snippet has script tag",/^<script\s.+><\/script>$/.test(m)),l("includes data-embed-id",m.includes('data-embed-id="abc"')),l("includes variant",m.includes('data-variant="compact"')),l("includes theme",m.includes('data-theme="dark"'));const x=new URL(window.location.href);x.searchParams.set("token","T_URL");const C=x.searchParams.get("token")==="T_URL";l("URLSearchParams working",C),console.table(v.map(b=>({test:b.name,pass:b.pass,detail:b.detail})))})();
