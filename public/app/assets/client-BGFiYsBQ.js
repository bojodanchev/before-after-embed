import{c as O,j as e,R as P,r as l}from"./index-Rm22KMJ6.js";function A(){return l.useMemo(()=>new URLSearchParams(window.location.search),[])}function f(){return e.jsx("header",{className:"w-full border-b border-slate-200/50 bg-white/70 backdrop-blur supports-[backdrop-filter]:bg-white/60 dark:border-slate-800 dark:bg-slate-900/60",children:e.jsxs("div",{className:"mx-auto max-w-6xl px-4 py-3 flex items-center justify-between",children:[e.jsxs("a",{href:"/",className:"flex items-center gap-2 font-semibold",children:[e.jsx("span",{className:"h-2.5 w-2.5 rounded-sm bg-gradient-to-br from-blue-400 to-violet-400"}),e.jsx("span",{children:"Before/After"})]}),e.jsxs("nav",{className:"flex items-center gap-4 text-sm text-slate-600 dark:text-slate-300",children:[e.jsx("a",{href:"/",className:"hover:text-slate-900 dark:hover:text-white",children:"Home"}),e.jsx("a",{href:"/admin.html",className:"hover:text-slate-900 dark:hover:text-white",children:"Admin"})]})]})})}async function k(i,r){const d=await fetch(i,{headers:r?{Authorization:`Bearer ${r}`}:{}});if(!d.ok)throw new Error(await d.text());return d.json()}async function v(i,r,d,n){const o=await fetch(i,{method:r,headers:Object.assign({"Content-Type":"application/json"},n?{Authorization:`Bearer ${n}`}:{}),body:JSON.stringify(d||{})}),x=await o.json().catch(()=>({}));if(!o.ok)throw new Error(x.error||"Request failed");return x}function h({title:i,children:r}){return e.jsxs("section",{className:"bg-white dark:bg-slate-900/80 border border-slate-200 dark:border-slate-800 rounded-xl p-5 shadow-sm",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:i}),r]})}function B(){const i=A(),[r,d]=l.useState(()=>i.get("token")||localStorage.getItem("clientToken")||""),[n,o]=l.useState(null),[x,y]=l.useState([]),[N,u]=l.useState(""),[w,S]=l.useState("");l.useEffect(()=>{(async()=>{try{const t=await k("/api/client/me",r);o(t.client)}catch{o(null)}})()},[r]);async function C(){u("Creating link...");try{const t=await v("/api/client/me","POST",{email:w}),s=new URL(t.link,location.origin).searchParams.get("token");s&&(localStorage.setItem("clientToken",s),d(s),window.history.replaceState({},"","/app/client.html?token="+encodeURIComponent(s))),u("")}catch(t){u("Error: "+t.message)}}function E(){localStorage.removeItem("clientToken"),d(""),o(null),window.history.replaceState({},"","/app/client.html")}async function b(){const t=await k("/api/client/embeds",r);y(t.embeds||[])}async function T(t){const c=t.id.value.trim(),s=t.vertical.value,a=t.theme.value;await v("/api/client/embeds","POST",{id:c,vertical:s,theme:a},r),await b(),t.reset()}function I({id:t,preset:c,theme:s}){const a=c==="compact"?{theme:s,variant:"compact",maxWidth:"640px",align:"center",radius:"14px",shadow:"true",border:"true",width:"100%",height:"460px"}:{theme:s,variant:"card",maxWidth:"980px",align:"left",radius:"12px",shadow:"true",border:"true",width:"100%",height:"520px"};return`<script async src="https://before-after-embed.vercel.app/embed.js" ${Object.entries({"data-embed-id":t,"data-theme":a.theme,"data-variant":a.variant,"data-max-width":a.maxWidth,"data-align":a.align,"data-radius":a.radius,"data-shadow":a.shadow,"data-border":a.border,"data-width":a.width,"data-height":a.height}).map(([j,m])=>`${j}="${m}"`).join(" ")}><\/script>`}if(l.useEffect(()=>{n&&b()},[n]),!n&&!r)return e.jsxs("div",{children:[e.jsx(f,{}),e.jsx("main",{className:"mx-auto max-w-6xl px-4 py-8 grid gap-6",children:e.jsxs(h,{title:"Client sign-in",children:[e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx("input",{className:"flex-1 rounded-lg border border-slate-300 px-3 py-2 dark:bg-slate-900 dark:border-slate-700",placeholder:"you@example.com",value:w,onChange:t=>S(t.target.value)}),e.jsx("button",{className:"rounded-lg bg-blue-600 text-white px-4 py-2",onClick:C,children:"Send magic link"})]}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:N})]})})]});if(!n)return e.jsxs("div",{children:[e.jsx(f,{}),e.jsx("main",{className:"mx-auto max-w-6xl px-4 py-10 text-slate-600 dark:text-slate-300",children:"Loading..."})]});return e.jsxs("div",{children:[e.jsx(f,{}),e.jsxs("main",{className:"mx-auto max-w-6xl px-4 py-8 grid gap-6",children:[e.jsx(h,{title:"Client",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-slate-700 dark:text-slate-300",children:["Hello, ",n.name," (id: ",n.id,")"]}),e.jsx("button",{className:"rounded-lg border border-slate-300 px-3 py-2 dark:border-slate-700",onClick:E,children:"Sign out"})]})}),e.jsxs(h,{title:"Your Embeds",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("button",{className:"rounded-lg border border-slate-300 px-3 py-2 dark:border-slate-700",onClick:b,children:"Refresh"})}),e.jsx("pre",{className:"text-sm whitespace-pre-wrap bg-slate-50 dark:bg-slate-900/60 p-3 rounded-lg border border-slate-200 dark:border-slate-800",children:JSON.stringify(x,null,2)}),e.jsxs("form",{className:"mt-3 grid sm:grid-cols-[1fr,200px,160px,auto] gap-3",onSubmit:t=>{t.preventDefault(),T(t.currentTarget)},children:[e.jsx("input",{name:"id",placeholder:"new embed id",className:"rounded-lg border border-slate-300 px-3 py-2 dark:bg-slate-900 dark:border-slate-700"}),e.jsxs("select",{name:"vertical",className:"rounded-lg border border-slate-300 px-3 py-2 dark:bg-slate-900 dark:border-slate-700",children:[e.jsx("option",{value:"barber",children:"barber"}),e.jsx("option",{value:"dental",children:"dental"}),e.jsx("option",{value:"detailing",children:"detailing"})]}),e.jsxs("select",{name:"theme",className:"rounded-lg border border-slate-300 px-3 py-2 dark:bg-slate-900 dark:border-slate-700",children:[e.jsx("option",{value:"light",children:"light"}),e.jsx("option",{value:"dark",children:"dark"})]}),e.jsx("button",{className:"rounded-lg bg-blue-600 text-white px-4 py-2",children:"Create embed"})]})]}),e.jsx(h,{title:"Snippet Preset",children:e.jsx(R,{})})]})]});function R(){const[t,c]=l.useState(""),[s,a]=l.useState("compact"),[g,j]=l.useState("light"),m=I({id:t,preset:s,theme:g});return e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"grid gap-3 sm:grid-cols-[1fr,160px,160px,auto]",children:[e.jsx("input",{value:t,onChange:p=>c(p.target.value),placeholder:"embedId",className:"rounded-lg border border-slate-300 px-3 py-2 dark:bg-slate-900 dark:border-slate-700"}),e.jsxs("select",{value:s,onChange:p=>a(p.target.value),className:"rounded-lg border border-slate-300 px-3 py-2 dark:bg-slate-900 dark:border-slate-700",children:[e.jsx("option",{value:"compact",children:"Compact"}),e.jsx("option",{value:"card",children:"Card"})]}),e.jsxs("select",{value:g,onChange:p=>j(p.target.value),className:"rounded-lg border border-slate-300 px-3 py-2 dark:bg-slate-900 dark:border-slate-700",children:[e.jsx("option",{value:"light",children:"Light"}),e.jsx("option",{value:"dark",children:"Dark"})]}),e.jsx("button",{className:"rounded-lg border border-slate-300 px-3 py-2 dark:border-slate-700",onClick:()=>{try{navigator.clipboard.writeText(m)}catch{}},children:"Copy snippet"})]}),e.jsx("pre",{className:"text-sm whitespace-pre-wrap bg-slate-50 dark:bg-slate-900/60 p-3 rounded-lg border border-slate-200 dark:border-slate-800",children:m})]})}}O.createRoot(document.getElementById("root")).render(e.jsx(P.StrictMode,{children:e.jsx(B,{})}));
