import{R as Je,j as e,a as at,c as _e,b as he,r as n}from"./index-C7_ulAzu.js";const it=()=>{const i=new URLSearchParams(window.location.search).get("token");if(i)return i;try{return localStorage.getItem("clientToken")||""}catch{return""}},ze=a=>{try{localStorage.setItem("clientToken",a)}catch{}},rt=()=>{try{localStorage.removeItem("clientToken")}catch{}};async function ee(a){try{const i=await a.json();return(i==null?void 0:i.error)||(i==null?void 0:i.message)||`${a.status}`}catch{return`${a.status} ${a.statusText}`}}const nt="https://before-after-embed.vercel.app/embed.js",lt=a=>a.replace(/[A-Z]/g,i=>`-${i.toLowerCase()}`),me=(a,i={},m={})=>{const p={embedId:a||"your-embed-id",..."attrs"in i?i.attrs:i,...m},c=["async",`src="${nt}"`];return Object.entries(p).forEach(([v,y])=>{if(y==null||y==="")return;const j=`data-${lt(v.replace(/^data-/,""))}`;c.push(`${j}="${String(y)}"`)}),`<script ${c.join(" ")}><\/script>`},ot=[{id:"light",name:"Light",subtitle:"Bright card for white backgrounds",attrs:{theme:"light",wide:"true",border:"true",shadow:"false",radius:"18px",align:"center",height:"520px"},preview:{bg:"#f8fafc",fg:"#0f172a"},copy:{headline:"Show the transformation instantly",body:"Upload, generate, and drag the slider so customers see the clean finish before booking."}},{id:"dark",name:"Dark",subtitle:"Glassmorphism card for dark sites",attrs:{theme:"dark",wide:"true",border:"true",shadow:"true",radius:"20px",align:"center",height:"520px"},preview:{bg:"#0b1120",fg:"#f8fafc"},copy:{headline:"Bring the shine forward",body:"Let visitors preview your AI enhancements without leaving the page."}},{id:"brand",name:"Brand color",subtitle:"Uses your accent color for buttons and pills",attrs:{theme:"light",wide:"true",border:"true",shadow:"true",radius:"18px",align:"center",height:"520px"},preview:{bg:"#ffffff",fg:"#0f172a"},copy:{headline:"Spotlight your signature look",body:"Buttons, pills, and slider accents inherit your brand color automatically."}},{id:"minimal",name:"Minimal",subtitle:"Compact embed for sidebars and narrow sections",attrs:{theme:"auto",wide:"false",border:"false",shadow:"false",radius:"8px",align:"left",height:"420px"},preview:{bg:"#f1f5f9",fg:"#111827"},copy:{headline:"Drop into any sidebar",body:"The compact layout keeps controls stacked for a quick install."}}],dt=({className:a="",children:i})=>e.jsx("div",{className:`mx-auto w-full max-w-6xl px-4 sm:px-6 ${a}`,children:i}),X=({title:a,children:i})=>e.jsxs("section",{className:"rounded-2xl border border-white/10 bg-white/5 p-4 sm:p-6",children:[a&&e.jsx("h2",{className:"text-base font-semibold",children:a}),e.jsx("div",{className:a?"mt-3":"",children:i})]}),w=({variant:a="primary",className:i="",children:m,...p})=>{const c="inline-flex items-center justify-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition",v={primary:"text-white bg-gradient-to-r from-violet-600 via-pink-500 to-cyan-400 hover:opacity-90 disabled:opacity-60",outline:"border border-white/20 bg-transparent text-white hover:bg-white/10",subtle:"bg-white/10 text-white hover:bg-white/20"};return e.jsx("button",{className:`${c} ${v[a]} ${i}`,...p,children:m})},M=a=>e.jsx("input",{...a,className:"w-full rounded-md border border-white/20 bg-neutral-900 p-2 text-sm text-white placeholder-white/50 focus:ring-2 focus:ring-violet-500"}),R=({children:a,...i})=>e.jsx("select",{...i,className:"w-full rounded-md border border-white/20 bg-neutral-900 p-2 text-sm text-white focus:ring-2 focus:ring-violet-500",children:a}),ct=({children:a})=>e.jsx("code",{className:"rounded-md bg-black/40 px-1.5 py-0.5 text-[12px]",children:a}),L=({children:a})=>e.jsx("span",{className:"text-xs font-medium text-white/70",children:a}),Ge=["#f97316","#6366f1","#22d3ee","#ef4444","#10b981","#fbbf24"],ht=({step:a,total:i})=>e.jsx("div",{className:"flex items-center justify-center gap-2 text-xs text-white/60",children:Array.from({length:i}).map((m,p)=>e.jsx("span",{className:`h-2 w-2 rounded-full ${p+1<=a?"bg-white":"bg-white/20"}`},p))}),xt=({t:a,canCustomize:i,brandColor:m,onApply:p,onPreview:c,setToast:v})=>{const y=i?Ge.length:2,j=n.useRef(null),[C,$]=n.useState(!1),[l,P]=n.useState(null);n.useEffect(()=>{P(null)},[i]);const A=(g,S)=>{g&&(S&&!i?(c(g),P(g),v(a("Previewing premium color â€” upgrade to save","ÐŸÑ€ÐµÐ³Ð»ÐµÐ´ Ð½Ð° Ð¿Ñ€ÐµÐ¼Ð¸ÑƒÐ¼ Ñ†Ð²ÑÑ‚ â€” ÑŠÐ¿Ð³Ñ€ÐµÐ¹Ð´ Ð·Ð° Ð·Ð°Ð¿Ð¸Ñ"))):(c(null),p(g),P(null)))},ae=(g,S)=>{const d=!i&&S>=y;A(g,d)},r=()=>{var g;(g=j.current)==null||g.click()},N=g=>new Promise((S,d)=>{const E=new FileReader;E.onload=()=>{const te=new Image;te.onload=()=>{try{const W=document.createElement("canvas"),H=48;W.width=H,W.height=H;const ie=W.getContext("2d");ie.drawImage(te,0,0,H,H);const U=ie.getImageData(0,0,H,H).data;let O=0,K=0,F=0,_=U.length/4;for(let B=0;B<U.length;B+=4)O+=U[B],K+=U[B+1],F+=U[B+2];O=Math.round(O/_),K=Math.round(K/_),F=Math.round(F/_);const Q=`#${[O,K,F].map(B=>B.toString(16).padStart(2,"0")).join("")}`;S(Q)}catch(W){d(W)}},te.onerror=d,te.src=E.result},E.onerror=d,E.readAsDataURL(g)}),D=async g=>{var d;const S=(d=g.target.files)==null?void 0:d[0];if(g.target.value="",!!S){$(!0);try{const E=await N(S);A(E,!i)}catch{v(a("Could not read that logo. Try another image.","ÐÐµÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¸Ð·Ð²Ð»Ð¸Ñ‡Ð°Ð½Ðµ Ð¾Ñ‚ Ð»Ð¾Ð³Ð¾Ñ‚Ð¾. ÐžÐ¿Ð¸Ñ‚Ð°Ð¹Ñ‚Ðµ Ð´Ñ€ÑƒÐ³ Ñ„Ð°Ð¹Ð»."))}finally{$(!1)}}};return e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{children:a("Brand color","Ð‘Ñ€Ð°Ð½Ð´ Ñ†Ð²ÑÑ‚")}),e.jsx("span",{className:"rounded-full bg-white/10 px-2 py-0.5 text-[10px] text-white/70",children:a("Tint buttons and active chips","ÐÐºÑ†ÐµÐ½Ñ‚Ð¸Ñ€Ð°Ð½ Ñ†Ð²ÑÑ‚")}),!i&&e.jsxs("span",{className:"rounded-md bg-amber-500/20 px-2 py-1 text-xs text-amber-300",title:a("Upgrade to Growth or Pro plan to unlock custom brand colors","ÐªÐ¿Ð³Ñ€ÐµÐ¹Ð´Ð½ÐµÑ‚Ðµ Ð´Ð¾ Growth Ð¸Ð»Ð¸ Pro Ð¿Ð»Ð°Ð½ Ð·Ð° Ð´Ð° Ð¾Ñ‚ÐºÐ»ÑŽÑ‡Ð¸Ñ‚Ðµ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð°Ð½Ð¸ Ñ†Ð²ÐµÑ‚Ð¾Ð²Ðµ"),children:["ðŸ”’ ",a("Growth/Pro only","Ð¡Ð°Ð¼Ð¾ Growth/Pro")]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[Ge.map((g,S)=>{const d=(m==null?void 0:m.toLowerCase())===g.toLowerCase()||l===g,E=!i&&S>=y;return e.jsx("button",{type:"button",className:`h-8 w-8 rounded-full border transition ${d?"border-white":"border-white/10"} ${E?"opacity-50":""}`,style:{background:g},onClick:()=>ae(g,S),"aria-label":`Accent ${g}${E?" (locked)":""}`},g)}),e.jsx("button",{type:"button",onClick:r,className:"inline-flex items-center gap-1 rounded-full border border-white/20 bg-white/10 px-3 py-1 text-xs text-white hover:bg-white/20",disabled:C,children:C?a("Detectingâ€¦","Ð˜Ð·Ð²Ð»Ð¸Ñ‡Ð°Ð½Ðµâ€¦"):a("Match logo","Ð¦Ð²ÑÑ‚ Ð¾Ñ‚ Ð»Ð¾Ð³Ð¾")}),e.jsx("input",{ref:j,type:"file",accept:"image/*",className:"hidden",onChange:D}),i&&e.jsx("input",{type:"color",value:m,onChange:g=>A(g.target.value,!1),className:"h-8 w-12 cursor-pointer rounded border border-white/20 bg-transparent","aria-label":"Custom color"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-white/60",children:[e.jsxs("span",{children:[a("Current accent","Ð¢ÐµÐºÑƒÑ‰ Ð°ÐºÑ†ÐµÐ½Ñ‚"),": ",m]}),l&&!i&&e.jsx("span",{className:"rounded bg-white/10 px-2 py-0.5 text-[10px] text-amber-300",children:a("Preview only â€¢ upgrade to apply","Ð¡Ð°Ð¼Ð¾ Ð¿Ñ€ÐµÐ³Ð»ÐµÐ´ â€¢ ÑŠÐ¿Ð³Ñ€ÐµÐ¹Ð´ Ð·Ð° Ð·Ð°Ð¿Ð¸Ñ")})]})]})},mt=({open:a,step:i,placement:m,snippet:p,onClose:c,onCopy:v,onNext:y,onPrev:j,onPlacement:C,onPreview:$,t:l})=>{if(!a)return null;const P=3;return e.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/70 px-4",children:e.jsxs("div",{className:"w-full max-w-xl rounded-2xl border border-white/10 bg-neutral-950 p-6 shadow-2xl",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:l("Guided setup","Ð ÑŠÐºÐ¾Ð²Ð¾Ð´ÑÑ‚Ð²Ð¾ Ð·Ð° Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°")}),e.jsx("p",{className:"mt-1 text-xs text-white/60",children:l("Follow the steps to embed Before/After in under a minute.","Ð¡Ð»ÐµÐ´Ð²Ð°Ð¹Ñ‚Ðµ ÑÑ‚ÑŠÐ¿ÐºÐ¸Ñ‚Ðµ, Ð·Ð° Ð´Ð° Ð²Ð³Ñ€Ð°Ð´Ð¸Ñ‚Ðµ Before/After Ð·Ð° Ð¿Ð¾-Ð¼Ð°Ð»ÐºÐ¾ Ð¾Ñ‚ Ð¼Ð¸Ð½ÑƒÑ‚Ð°.")})]}),e.jsx("button",{onClick:c,className:"rounded-full border border-white/20 bg-white/10 px-2 py-1 text-sm text-white/60 hover:bg-white/20",children:"âœ•"})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs uppercase tracking-wide text-white/40",children:[l("Step","Ð¡Ñ‚ÑŠÐ¿ÐºÐ°")," ",i," / ",P]}),e.jsx(ht,{step:i,total:P})]}),e.jsxs("div",{className:"mt-4 space-y-4 text-sm text-white",children:[i===1&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:l("Copy the embed script and paste it anywhere on your site where you want the widget to appear.","ÐšÐ¾Ð¿Ð¸Ñ€Ð°Ð¹Ñ‚Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð° Ð¸ Ð³Ð¾ Ð¿Ð¾ÑÑ‚Ð°Ð²ÐµÑ‚Ðµ Ð½Ð° ÑÐ°Ð¹Ñ‚Ð° ÑÐ¸ Ñ‚Ð°Ð¼, ÐºÑŠÐ´ÐµÑ‚Ð¾ Ð¸ÑÐºÐ°Ñ‚Ðµ Ð´Ð° ÑÐµ Ð¿Ð¾ÑÐ²Ð¸ Ð²Ð¸Ð´Ð¶ÐµÑ‚ÑŠÑ‚.")}),e.jsxs("div",{className:"rounded-xl border border-white/10 bg-black/40 p-3 text-xs text-white/80",children:[e.jsx("pre",{className:"max-h-48 overflow-auto whitespace-pre-wrap break-words",children:p}),e.jsx(w,{className:"mt-3",onClick:v,children:l("Copy script","ÐšÐ¾Ð¿Ð¸Ñ€Ð°Ð¹ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð°")})]})]}),i===2&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:l("Where will it sit on the page? Choose a layout and weâ€™ll tailor the embed automatically.","ÐšÑŠÐ´Ðµ Ñ‰Ðµ ÑÑ‚Ð¾Ð¸ Ð½Ð° ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ð°Ñ‚Ð°? Ð˜Ð·Ð±ÐµÑ€ÐµÑ‚Ðµ Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð¸ Ñ‰Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¸Ð¼ ÐµÐ¼Ð±ÐµÐ´Ð° Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡Ð½Ð¾.")}),e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[e.jsxs("button",{type:"button",onClick:()=>C("wide"),className:`rounded-xl border px-4 py-3 text-left transition ${m==="wide"?"border-white bg-white/10 shadow-lg":"border-white/10 bg-black/30 hover:border-white/30"}`,children:[e.jsx("div",{className:"text-sm font-semibold",children:l("Full-width section","ÐŸÑŠÐ»Ð½Ð° ÑˆÐ¸Ñ€Ð¸Ð½Ð°")}),e.jsx("p",{className:"mt-1 text-xs text-white/70",children:l("Best for hero or feature sections.","ÐŸÐ¾Ð´Ñ…Ð¾Ð´ÑÑ‰Ð¾ Ð·Ð° Ñ…ÐµÑ€Ð¾ Ð¸Ð»Ð¸ Ð¾ÑÐ½Ð¾Ð²Ð½Ð¸ ÑÐµÐºÑ†Ð¸Ð¸.")})]}),e.jsxs("button",{type:"button",onClick:()=>C("sidebar"),className:`rounded-xl border px-4 py-3 text-left transition ${m==="sidebar"?"border-white bg-white/10 shadow-lg":"border-white/10 bg-black/30 hover:border-white/30"}`,children:[e.jsx("div",{className:"text-sm font-semibold",children:l("Sidebar or narrow column","Ð¡Ñ‚Ñ€Ð°Ð½Ð¸Ñ‡Ð½Ð° ÐºÐ¾Ð»Ð¾Ð½Ð°")}),e.jsx("p",{className:"mt-1 text-xs text-white/70",children:l("Keeps everything stacked in a compact panel.","ÐšÐ¾Ð¼Ð¿Ð°ÐºÑ‚ÐµÐ½ Ð¿Ð°Ð½ÐµÐ» Ð·Ð° Ñ‚ÐµÑÐ½Ð¸ Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²Ð°.")})]})]})]}),i===3&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:l("Open a staging preview to test the widget before you paste it live.","ÐžÑ‚Ð²Ð¾Ñ€ÐµÑ‚Ðµ Ñ‚ÐµÑÑ‚Ð¾Ð² Ð¿Ñ€ÐµÐ³Ð»ÐµÐ´, Ð·Ð° Ð´Ð° Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚Ðµ Ð²Ð¸Ð´Ð¶ÐµÑ‚Ð° Ð¿Ñ€ÐµÐ´Ð¸ Ð´Ð° Ð³Ð¾ Ð¿Ð¾ÑÑ‚Ð°Ð²Ð¸Ñ‚Ðµ Ð½Ð° Ð¶Ð¸Ð²Ð¾.")}),e.jsx(w,{onClick:$,children:l("Open test drive","ÐžÑ‚Ð²Ð¾Ñ€Ð¸ Ñ‚ÐµÑÑ‚Ð¾Ð² Ð¿Ñ€ÐµÐ³Ð»ÐµÐ´")}),e.jsx("p",{className:"text-xs text-white/60",children:l("The preview opens in a new tab with your current settings.","ÐŸÑ€ÐµÐ³Ð»ÐµÐ´ÑŠÑ‚ ÑÐµ Ð¾Ñ‚Ð²Ð°Ñ€Ñ Ð² Ð½Ð¾Ð² Ñ€Ð°Ð·Ð´ÐµÐ» Ñ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ñ‚Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸.")})]})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[e.jsx(w,{variant:"subtle",onClick:i===1?c:j,children:i===1?l("Close","Ð—Ð°Ñ‚Ð²Ð¾Ñ€Ð¸"):l("Back","ÐÐ°Ð·Ð°Ð´")}),e.jsx(w,{onClick:i===P?c:y,children:i===P?l("Done","Ð“Ð¾Ñ‚Ð¾Ð²Ð¾"):l("Next","Ð¡Ð»ÐµÐ´Ð²Ð°Ñ‰Ð°")})]})]})})};function pt(){const[a,i]=n.useState("");return n.useEffect(()=>{const p=new URLSearchParams(window.location.search),c=p.get("token")||it();c&&(i(c),ze(c),p.get("token")&&(p.delete("token"),window.history.replaceState({},"",window.location.pathname)))},[]),[a,p=>{i(p||""),p?ze(p):rt()}]}function ut(){const[a,i]=n.useState(""),[m,p]=n.useState(!1),[c,v]=n.useState(""),[y,j]=n.useState(""),C=async()=>{p(!0),v(""),j("");try{const l=await fetch("/api/client/me",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a})});if(!l.ok)throw new Error(await ee(l));await l.json(),j("Sign-in link sent. Check your email.")}catch(l){v(typeof(l==null?void 0:l.message)=="string"?l.message:"Failed to send sign-in link")}finally{p(!1)}},$=async l=>{l.preventDefault(),m||C()};return e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-neutral-950 text-white",children:e.jsxs("form",{onSubmit:$,className:"w-full max-w-sm rounded-xl border border-white/10 bg-white/5 p-6",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Client Portal Sign In"}),e.jsx(M,{type:"email",placeholder:"you@example.com",value:a,onChange:l=>i(l.target.value),required:!0}),e.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[e.jsx(w,{type:"submit",className:"flex-1",disabled:m,children:m?"Sendingâ€¦":"Send link"}),e.jsx(w,{type:"button",variant:"subtle",disabled:m||!a,onClick:C,children:"Resend"})]}),!!c&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:c}),!!y&&e.jsx("p",{className:"mt-2 text-sm text-white/70",children:y})]})})}function gt({token:a,onSignOut:i}){var Be,Te,Re,Ue,Le,Ae,De,Ie,Me,Oe;const[m,p]=n.useState(null),[c,v]=n.useState([]),[y,j]=n.useState(!0),[C,$]=n.useState(""),[l,P]=n.useState({id:"",vertical:"barber",theme:"dark"}),[A,ae]=n.useState(()=>{try{return localStorage.getItem("lang")||"en"}catch{return"en"}});n.useEffect(()=>{try{localStorage.setItem("lang",A)}catch{}},[A]);const r=(t,s)=>A==="bg"?s:t,[N,D]=n.useState(null),[g,S]=n.useState(!1),[d,E]=n.useState(null),[te,W]=n.useState(0),[H,ie]=n.useState(0),[U,O]=n.useState(""),[K,F]=n.useState(null),_=K||(N==null?void 0:N.brandColor)||"#f97316",Q=n.useMemo(()=>ot.map(t=>t.id==="brand"?{...t,attrs:{...t.attrs,brandColor:_},preview:{...t.preview,accent:_}}:t),[_]),[B,le]=n.useState("light"),b=n.useMemo(()=>Q.find(t=>t.id===B)||Q[0],[Q,B]),J=n.useMemo(()=>{var o,h;const t=U||((o=c[0])==null?void 0:o.id)||"your-embed-id",s=(h=c.find(u=>u.id===t))==null?void 0:h.vertical;return me(t,b||{},s?{vertical:s}:{})},[U,c,b]),pe=Je.useRef(null),ue=(t="")=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),ge=t=>{var s,o,h,u,z,k;try{const T=pe.current;if(!T)return;const V=T.contentDocument||((s=T.contentWindow)==null?void 0:s.document);if(!V)return;const G=b||{},ne=((o=G.preview)==null?void 0:o.bg)||"#0b1120",Xe=((h=G.preview)==null?void 0:h.fg)||"#f8fafc",Fe=((u=G.attrs)==null?void 0:u.align)==="left"?"flex-start":"center",et=ue(((z=G.copy)==null?void 0:z.headline)||"Before & After preview"),tt=ue(((k=G.copy)==null?void 0:k.body)||"Upload, generate, and drag the slider to compare results."),st=`<!doctype html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/></head><body style="margin:0;background:${ne};color:${Xe};font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;display:flex;flex-direction:column;gap:16px;align-items:${Fe};padding:32px 24px;"><div style="max-width:680px;text-align:${Fe==="center"?"center":"left"}"><h2 style="margin:0;font-size:22px;font-weight:600;">${et}</h2><p style="margin:8px 0 0;font-size:14px;opacity:0.78;">${tt}</p></div>${t}</body></html>`;V.open(),V.write(st),V.close()}catch{}};n.useEffect(()=>{const t=setTimeout(()=>ge(J),200);return()=>clearTimeout(t)},[J,b]),n.useEffect(()=>{F(null)},[N==null?void 0:N.brandColor]),n.useEffect(()=>{const t=new URLSearchParams(window.location.search);if(t.get("showInstaller")==="1"){de(!0),t.delete("showInstaller");const s=new URL(window.location.href);s.search=t.toString(),window.history.replaceState({},"",s.toString())}},[]);const[Z,be]=n.useState(""),[we,fe]=n.useState([]),[je,ve]=n.useState(!1),[ye,q]=n.useState(""),[x,Ne]=n.useState(null),[ke,Se]=n.useState(!1),[oe,de]=n.useState(!1),[qe,se]=n.useState(1),[Ce,Ve]=n.useState("wide");n.useEffect(()=>{oe&&Pe(Ce)},[oe]);const $e=async()=>{try{await navigator.clipboard.writeText(J),q(r("Snippet copied","ÐšÐ¾Ð´ÑŠÑ‚ Ðµ ÐºÐ¾Ð¿Ð¸Ñ€Ð°Ð½"))}catch{q(r("Copy failed. Select and copy manually.","ÐšÐ¾Ð¿Ð¸Ñ€Ð°Ð½ÐµÑ‚Ð¾ Ð½ÐµÑƒÑÐ¿ÐµÑˆÐ½Ð¾. Ð˜Ð·Ð±ÐµÑ€ÐµÑ‚Ðµ Ð¸ ÐºÐ¾Ð¿Ð¸Ñ€Ð°Ð¹Ñ‚Ðµ Ñ€ÑŠÑ‡Ð½Ð¾."))}},Pe=t=>{Ve(t),t==="sidebar"?le("minimal"):t==="wide"&&B==="minimal"&&le("light"),se(s=>s===2?3:s)},Ke=()=>{var V,G,ne;const t=b||{},s=((V=t.preview)==null?void 0:V.bg)||"#0b1120",o=((G=t.preview)==null?void 0:G.fg)||"#f8fafc",h=((ne=t.attrs)==null?void 0:ne.align)==="left"?"flex-start":"center",u=`<!doctype html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/></head><body style="margin:0;background:${s};color:${o};font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;display:flex;flex-direction:column;gap:24px;align-items:${h};padding:48px 32px;">
      <h1 style="margin:0;font-size:24px;font-weight:600;">Before/After Test Drive</h1>
      <p style="margin:0;font-size:14px;opacity:0.75;max-width:640px;">Paste this embed on your site to recreate the experience below.</p>
      ${J}
    </body></html>`,z=new Blob([u],{type:"text/html"}),k=URL.createObjectURL(z);window.open(k,"_blank","noopener")&&setTimeout(()=>URL.revokeObjectURL(k),1e4)},[Qe,re]=n.useState(!1),[f,I]=n.useState({id:"",name:"",vertical:"barber",theme:"dark",width:"100%",height:"520px",variant:"card",radius:"12px",shadow:"true",border:"true"}),Y=async()=>{try{j(!0),$("");const t=await fetch("/api/client/me",{headers:{Authorization:`Bearer ${a}`}});if(!t.ok)throw new Error("Auth failed");const s=await t.json();p((s==null?void 0:s.client)||s);const o=await fetch("/api/client/embeds",{headers:{Authorization:`Bearer ${a}`}});if(!o.ok)throw new Error(await ee(o));const h=await o.json(),u=Array.isArray(h)?h:(h==null?void 0:h.embeds)||[];v(u);try{const k=await(await fetch("/api/client/settings",{headers:{Authorization:`Bearer ${a}`}})).json();D((k==null?void 0:k.settings)||{}),E((k==null?void 0:k.plan)||null)}catch{}!U&&u.length&&O(u[0].id),!Z&&u.length&&be(u[0].id)}catch{$("Failed to load data")}finally{j(!1)}};n.useEffect(()=>{Y()},[a]),n.useEffect(()=>{(async()=>{try{const t=new URLSearchParams(window.location.search),s=t.get("nextPlan");if(!s)return;t.delete("nextPlan");const o=new URL(window.location.href);o.search=t.toString(),window.history.replaceState({},"",o.toString());const h=await fetch("/api/billing/checkout",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({planId:s})}),u=await h.json();if(!h.ok)throw new Error((u==null?void 0:u.error)||"Checkout failed");u!=null&&u.url&&(window.location.href=u.url)}catch{}})()},[a]);const Ze=async t=>{t.preventDefault();try{const s=await fetch("/api/client/embeds",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify(l)});if(!s.ok)throw new Error(await ee(s));P({id:"",vertical:l.vertical,theme:l.theme}),Y()}catch(s){$(typeof(s==null?void 0:s.message)=="string"?s.message:"Failed to create embed")}},Ye=async(t,s)=>{try{const o=await fetch("/api/client/embeds",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({id:t,theme:s})});if(!o.ok)throw new Error(await ee(o));Y()}catch(o){$(typeof(o==null?void 0:o.message)=="string"?o.message:"Failed to update embed")}},ce=async t=>{if(t){ve(!0);try{const s=await fetch(`/api/client/stats?embedId=${encodeURIComponent(t)}`,{headers:{Authorization:`Bearer ${a}`}});if(!s.ok)throw new Error(await ee(s));const o=await s.json(),h=Array.isArray(o)?o:(o==null?void 0:o.events)||[];fe(h)}catch{fe([])}finally{ve(!1)}}},Ee=async()=>{Se(!0);try{const t=await fetch("/api/client/stats",{headers:{Authorization:`Bearer ${a}`}});if(!t.ok)throw new Error(await ee(t));const s=await t.json();Ne(s||null);try{const o=await fetch("/api/client/stats",{headers:{Authorization:`Bearer ${a}`}}),h=await o.json();if(!o.ok)throw new Error((h==null?void 0:h.error)||"Failed");E(h.plan||null),W(Number(h.monthlyUsed||0)),ie(Number(h.monthlyBonus||0))}catch{}}catch{Ne(null)}finally{Se(!1)}};return n.useEffect(()=>{const t=new URLSearchParams(window.location.search);if(t.get("success")==="1"){const s=t.get("topup")||t.get("plan")?t.get("topup")?`+${t.get("topup")} generations`:"Plan updated":"Success";q(`${s} ðŸŽ‰`),setTimeout(()=>q(""),3e3),t.delete("success"),t.delete("topup"),t.delete("plan");const o=new URL(window.location.href);o.search=t.toString(),window.history.replaceState({},"",o.toString()),Ee(),Z&&ce(Z)}},[]),y?e.jsx("div",{className:"p-6 text-white",children:"Loadingâ€¦"}):C?e.jsx("div",{className:"p-6 text-red-400",children:C}):e.jsxs("div",{className:"min-h-screen bg-neutral-950 text-white",children:[e.jsx("header",{className:"sticky top-0 z-10 border-b border-white/10 bg-neutral-950/80 backdrop-blur",children:e.jsxs(dt,{className:"flex h-14 items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"grid h-8 w-8 place-items-center rounded-xl bg-gradient-to-tr from-violet-500 via-pink-500 to-cyan-400 shadow",children:e.jsx("span",{className:"text-xs font-bold",children:"B/A"})}),e.jsx("div",{className:"text-sm font-semibold",children:r("Before/After Portal","ÐŸÐ¾Ñ€Ñ‚Ð°Ð» Before/After")})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[m&&e.jsxs("span",{children:[m.name," (",e.jsx(ct,{children:m.id}),")"]}),e.jsx(w,{variant:"outline",onClick:i,children:r("Sign out","Ð˜Ð·Ñ…Ð¾Ð´")}),e.jsxs("div",{className:"inline-flex items-center rounded-md border border-white/20 bg-white/5 p-0.5",children:[e.jsx("button",{onClick:()=>ae("en"),className:`${A==="en"?"bg-white/20 text-white":"text-white/80"} rounded px-2 py-1 text-xs`,children:"EN"}),e.jsx("button",{onClick:()=>ae("bg"),className:`${A==="bg"?"bg-white/20 text-white":"text-white/80"} rounded px-2 py-1 text-xs`,children:"BG"})]})]})]})}),e.jsxs("main",{className:"mx-auto max-w-6xl space-y-8 p-4",children:[!!ye&&e.jsx("div",{className:"fixed right-4 top-16 z-50 rounded-lg border border-emerald-400/30 bg-emerald-500/15 px-3 py-2 text-sm text-emerald-300 shadow-lg",children:ye}),!c.length&&e.jsxs("div",{className:"rounded-xl border border-white/10 bg-amber-500/10 p-4 text-sm text-amber-100",children:[r("New here? Use the guided setup to embed your widget in three quick steps.","Ð—Ð° Ð¿ÑŠÑ€Ð²Ð¸ Ð¿ÑŠÑ‚ ÑÑ‚Ðµ Ñ‚ÑƒÐº? ÐŸÑƒÑÐ½ÐµÑ‚Ðµ Ñ€ÑŠÐºÐ¾Ð²Ð¾Ð´ÑÑ‚Ð²Ð¾Ñ‚Ð¾ Ð·Ð° Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð² Ñ‚Ñ€Ð¸ ÑÑ‚ÑŠÐ¿ÐºÐ¸."),e.jsx(w,{className:"ml-3",variant:"subtle",onClick:()=>{se(1),de(!0)},children:r("Start guided setup","Ð¡Ñ‚Ð°Ñ€Ñ‚Ð¸Ñ€Ð°Ð¹Ñ‚Ðµ Ñ€ÑŠÐºÐ¾Ð²Ð¾Ð´ÑÑ‚Ð²Ð¾Ñ‚Ð¾")})]}),e.jsxs(X,{title:r("Embeds","Ð•Ð¼Ð±ÐµÐ´Ð¾Ð²Ðµ"),children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between rounded-md border border-white/10 bg-black/30 p-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"opacity-70",children:r("Current plan","Ð¢ÐµÐºÑƒÑ‰ Ð¿Ð»Ð°Ð½")}),e.jsx("div",{className:"font-medium",children:(d==null?void 0:d.name)||(d==null?void 0:d.id)||"free"})]}),e.jsx("div",{className:"rounded border border-white/10 bg-black/40 px-2 py-1 text-xs opacity-80",children:(()=>{const t=((d==null?void 0:d.id)||"free")==="free";return`${r("Watermark","Ð’Ð¾Ð´ÐµÐ½ Ð·Ð½Ð°Ðº")}: ${t?r("active","Ð°ÐºÑ‚Ð¸Ð²ÐµÐ½"):r("removed","Ð¿Ñ€ÐµÐ¼Ð°Ñ…Ð½Ð°Ñ‚")}`})()})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-xs opacity-70",children:[(d==null?void 0:d.monthlyGenerations)??0," ",r("gens / mo","Ð³ÐµÐ½./Ð¼ÐµÑÐµÑ†")]}),e.jsx("a",{href:"/app/pricing.html",className:"underline",children:r("Change plan","ÐŸÑ€Ð¾Ð¼ÑÐ½Ð° Ð½Ð° Ð¿Ð»Ð°Ð½")}),e.jsx("button",{className:"rounded-md border border-white/20 bg-white/10 px-2 py-1 text-xs hover:bg-white/20",onClick:async()=>{try{const t=await fetch("/api/billing/topup",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({units:1})}),s=await t.json();if(!t.ok)throw new Error((s==null?void 0:s.error)||"Top-up failed");s!=null&&s.url&&(window.location.href=s.url)}catch(t){alert(t.message||"Top-up failed")}},children:r("Buy +100","ÐšÑƒÐ¿Ð¸ +100")})]})]}),e.jsx("ul",{className:"space-y-2 text-sm",children:c.map(t=>e.jsxs("li",{className:"flex flex-col gap-2 rounded-md border border-white/10 bg-black/20 p-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"truncate",children:[t.id," â€“ ",t.vertical," â€“ ",t.theme]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(R,{value:t.theme,onChange:s=>Ye(t.id,s.target.value),children:[e.jsx("option",{value:"dark",children:"dark"}),e.jsx("option",{value:"light",children:"light"})]}),e.jsx(w,{variant:"outline",onClick:()=>{O(t.id),q(`${r("Snippet builder now uses","Ð¡Ð½Ð¸Ð¿ÐµÑ‚ÑŠÑ‚ Ð²ÐµÑ‡Ðµ Ð¸Ð·Ð¿Ð¾Ð»Ð·Ð²Ð°")} ${t.id}`)},children:"Use in builder"}),e.jsx(w,{variant:"outline",onClick:()=>{I({...t,variant:t.variant||"card",radius:t.radius||"12px",shadow:t.shadow??"true",border:t.border??"true"}),re(!0)},children:r("Edit","Ð ÐµÐ´Ð°ÐºÑ†Ð¸Ñ")}),e.jsx(w,{variant:"outline",onClick:async()=>{const s=`${t.id}-copy`;await fetch("/api/client/embeds",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({...t,id:s,name:t.name||s})}),Y()},children:r("Duplicate","Ð”ÑƒÐ±Ð»Ð¸Ñ€Ð°Ð¹")}),e.jsx(w,{variant:"outline",onClick:async()=>{if(!confirm(`Delete embed ${t.id}?`))return;const s=new URL("/api/client/embeds",location.origin);s.searchParams.set("id",t.id),await fetch(s.toString(),{method:"DELETE",headers:{Authorization:`Bearer ${a}`}}),Y()},children:r("Delete","Ð˜Ð·Ñ‚Ñ€Ð¸Ð¹")})]})]},t.id))}),e.jsxs("form",{onSubmit:Ze,className:"mt-4 grid gap-2 md:grid-cols-4",children:[e.jsx(M,{placeholder:"id",value:l.id,onChange:t=>P({...l,id:t.target.value}),required:!0}),e.jsxs(R,{value:l.vertical,onChange:t=>P({...l,vertical:t.target.value}),children:[e.jsx("option",{value:"barber",children:"barber"}),e.jsx("option",{value:"dental",children:"dental"}),e.jsx("option",{value:"detailing",children:"detailing"}),e.jsx("option",{value:"cosmetics",children:"cosmetics"}),e.jsx("option",{value:"custom",children:"custom"})]}),e.jsxs(R,{value:l.theme,onChange:t=>P({...l,theme:t.target.value}),children:[e.jsx("option",{value:"dark",children:"dark"}),e.jsx("option",{value:"light",children:"light"})]}),e.jsx(w,{type:"submit",className:"md:col-span-4",children:"Create"})]})]}),e.jsx(X,{title:"Client settings",children:N?e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"grid gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{children:"Display name"}),e.jsx("span",{className:"rounded-full bg-white/10 px-2 py-0.5 text-[10px] text-white/70",children:"Shown only in your portal"})]}),e.jsx(M,{value:N.displayName||"",onChange:t=>D(s=>({...s,displayName:t.target.value}))})]}),e.jsx(xt,{t:r,canCustomize:(d==null?void 0:d.themeCustomization)==="custom",brandColor:_,onPreview:t=>F(t),onApply:t=>D(s=>({...s,brandColor:t})),setToast:q}),e.jsxs("div",{className:"grid gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{children:"Default theme"}),e.jsx("span",{className:"rounded-full bg-white/10 px-2 py-0.5 text-[10px] text-white/70",children:"Light or dark for new embeds"})]}),e.jsxs(R,{value:N.defaultTheme||"dark",onChange:t=>D(s=>({...s,defaultTheme:t.target.value})),children:[e.jsx("option",{value:"dark",children:"dark"}),e.jsx("option",{value:"light",children:"light"})]})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{children:"Default variant"}),e.jsx("span",{className:"rounded-full bg-white/10 px-2 py-0.5 text-[10px] text-white/70",children:"Compact (inline) or Card (iframe)"})]}),e.jsxs(R,{value:N.defaultVariant||"card",onChange:t=>D(s=>({...s,defaultVariant:t.target.value})),children:[e.jsx("option",{value:"compact",children:"compact"}),e.jsx("option",{value:"card",children:"card"})]})]}),e.jsxs("details",{className:"md:col-span-2 rounded-md border border-white/10 bg-black/30 p-3",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-white/80",children:"Advanced"}),e.jsxs("div",{className:"mt-3 grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"grid gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{children:"Powered by"}),e.jsx("span",{className:"rounded-full bg-white/10 px-2 py-0.5 text-[10px] text-white/70",children:"Show small attribution"})]}),e.jsxs(R,{value:N.poweredBy||"false",onChange:t=>D(s=>({...s,poweredBy:t.target.value})),disabled:((d==null?void 0:d.id)||"free")==="free",children:[e.jsx("option",{value:"false",children:"hidden"}),e.jsx("option",{value:"true",children:"show"})]}),((d==null?void 0:d.id)||"free")==="free"&&e.jsx("div",{className:"text-xs text-white/50",children:"Required on Free plan"})]}),e.jsxs("div",{className:"grid gap-1 md:col-span-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{children:"Webhook URL"}),e.jsx("span",{className:"rounded-full bg-white/10 px-2 py-0.5 text-[10px] text-white/70",children:"Receive render events"})]}),e.jsx(M,{placeholder:"https://example.com/webhook",value:N.webhookUrl||"",onChange:t=>D(s=>({...s,webhookUrl:t.target.value}))})]})]})]}),e.jsx("div",{className:"md:col-span-2 flex gap-2 justify-end",children:e.jsx(w,{disabled:g,onClick:async()=>{S(!0);try{const t={...N};(d==null?void 0:d.themeCustomization)!=="custom"&&delete t.brandColor,await fetch("/api/client/settings",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify(t)}),F(null)}finally{S(!1)}},children:r("Save settings","Ð—Ð°Ð¿Ð°Ð·Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸Ñ‚Ðµ")})})]}):e.jsx("div",{className:"text-sm opacity-70",children:"Loadingâ€¦"})}),Qe&&e.jsx("div",{className:"fixed inset-0 z-50 grid place-items-center bg-black/50 p-4",children:e.jsxs("div",{className:"w-full max-w-xl rounded-xl border border-white/10 bg-neutral-950 p-4 text-white",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("div",{className:"text-lg font-semibold",children:"Edit embed"}),e.jsx("button",{className:"text-white/70",onClick:()=>re(!1),children:"âœ•"})]}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-white/70",children:"ID"}),e.jsx(M,{value:f.id,disabled:!0})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-white/70",children:"Name"}),e.jsx(M,{value:f.name||"",onChange:t=>I(s=>({...s,name:t.target.value}))})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-white/70",children:"Vertical"}),e.jsxs(R,{value:f.vertical,onChange:t=>I(s=>({...s,vertical:t.target.value})),children:[e.jsx("option",{value:"barber",children:"barber"}),e.jsx("option",{value:"dental",children:"dental"}),e.jsx("option",{value:"detailing",children:"detailing"}),e.jsx("option",{value:"cosmetics",children:"cosmetics"}),e.jsx("option",{value:"custom",children:"custom"})]})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-white/70",children:"Variant"}),e.jsxs(R,{value:f.variant,onChange:t=>I(s=>({...s,variant:t.target.value})),children:[e.jsx("option",{value:"compact",children:"compact"}),e.jsx("option",{value:"card",children:"card"})]})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-white/70",children:"Width"}),e.jsx(M,{value:f.width,onChange:t=>I(s=>({...s,width:t.target.value}))})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-white/70",children:"Height"}),e.jsx(M,{value:f.height,onChange:t=>I(s=>({...s,height:t.target.value}))})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-white/70",children:"Radius"}),e.jsx(M,{value:f.radius,onChange:t=>I(s=>({...s,radius:t.target.value}))})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-white/70",children:"Border"}),e.jsxs(R,{value:f.border,onChange:t=>I(s=>({...s,border:t.target.value})),children:[e.jsx("option",{value:"true",children:"true"}),e.jsx("option",{value:"false",children:"false"})]})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-white/70",children:"Shadow"}),e.jsxs(R,{value:f.shadow,onChange:t=>I(s=>({...s,shadow:t.target.value})),children:[e.jsx("option",{value:"true",children:"true"}),e.jsx("option",{value:"false",children:"false"})]})]})]}),e.jsxs("div",{className:"mt-4 grid gap-2 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 text-xs text-white/70",children:"Live preview"}),e.jsx("iframe",{title:"edit-preview",sandbox:"allow-scripts allow-forms allow-same-origin",style:{width:"100%",height:"360px",border:"0",borderRadius:"10px",background:"#0b0d10"},ref:t=>{var u;if(!t)return;const s={attrs:{theme:f.theme||"dark",variant:f.variant||"card",width:f.width||"100%",height:f.height||"520px",radius:f.radius||"12px",border:f.border??"true",shadow:f.shadow??"true"}},o=me(f.id,s,{vertical:f.vertical}),h=t.contentDocument||((u=t.contentWindow)==null?void 0:u.document);h&&(h.open(),h.write(`<!doctype html><html><body style="margin:0;background:#0b0d10">${o}</body></html>`),h.close())}})]}),e.jsxs("div",{className:"flex flex-col justify-end gap-2",children:[e.jsx(w,{onClick:async()=>{const t={...f};await fetch("/api/client/embeds",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify(t)}),re(!1),Y()},children:"Save changes"}),e.jsx(w,{variant:"subtle",onClick:()=>re(!1),children:"Cancel"})]})]})]})}),e.jsx(X,{title:r("Install your widget","Ð˜Ð½ÑÑ‚Ð°Ð»Ð¸Ñ€Ð°Ð¹Ñ‚Ðµ Ð²Ð¸Ð´Ð¶ÐµÑ‚Ð°"),children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-[minmax(0,1fr)_380px]",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:r("Step 1 Â· Choose embed","Ð¡Ñ‚ÑŠÐ¿ÐºÐ° 1 Â· Ð˜Ð·Ð±ÐµÑ€ÐµÑ‚Ðµ ÐµÐ¼Ð±ÐµÐ´")}),e.jsxs(R,{value:U||((Be=c[0])==null?void 0:Be.id)||"",onChange:t=>O(t.target.value),children:[c.map(t=>e.jsx("option",{value:t.id,children:t.id},t.id)),!c.length&&e.jsx("option",{value:"",children:r("No embeds yet","ÐÑÐ¼Ð° ÐµÐ¼Ð±ÐµÐ´Ð¸")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:r("Step 2 Â· Pick a style","Ð¡Ñ‚ÑŠÐ¿ÐºÐ° 2 Â· Ð˜Ð·Ð±ÐµÑ€ÐµÑ‚Ðµ ÑÑ‚Ð¸Ð»")}),e.jsx("div",{className:"grid gap-3 sm:grid-cols-2",children:Q.map(t=>e.jsxs("button",{type:"button",onClick:()=>le(t.id),className:`rounded-xl border px-4 py-3 text-left transition ${t.id===B?"border-white/60 bg-white/10 shadow-lg":"border-white/10 bg-black/20 hover:border-white/30"}`,children:[e.jsxs("div",{className:"flex items-center justify-between text-sm font-semibold",children:[e.jsx("span",{children:t.name}),t.id===B&&e.jsx("span",{className:"text-xs text-emerald-300",children:r("Selected","Ð˜Ð·Ð±Ñ€Ð°Ð½Ð¾")})]}),e.jsx("p",{className:"mt-1 text-xs text-white/70",children:t.subtitle})]},t.id))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:r("Step 3 Â· Copy & paste","Ð¡Ñ‚ÑŠÐ¿ÐºÐ° 3 Â· ÐšÐ¾Ð¿Ð¸Ñ€Ð°Ð¹Ñ‚Ðµ Ð¸ Ð¿Ð¾ÑÑ‚Ð°Ð²ÐµÑ‚Ðµ")}),e.jsxs("div",{className:"rounded-xl border border-white/10 bg-black/30 p-3",children:[e.jsx("pre",{className:"max-h-48 overflow-auto whitespace-pre-wrap break-words text-xs text-white/80",children:J}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[e.jsx(w,{onClick:$e,children:r("Copy snippet","ÐšÐ¾Ð¿Ð¸Ñ€Ð°Ð¹ ÐºÐ¾Ð´Ð°")}),e.jsx(w,{variant:"subtle",onClick:()=>ge(J),children:r("Refresh preview","ÐžÐ±Ð½Ð¾Ð²Ð¸ Ð¿Ñ€ÐµÐ³Ð»ÐµÐ´Ð°")})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:r("Suggested headline","ÐŸÑ€ÐµÐ¿Ð¾Ñ€ÑŠÑ‡Ð°Ð½Ð¾ Ð·Ð°Ð³Ð»Ð°Ð²Ð¸Ðµ")}),e.jsxs("div",{className:"rounded-xl border border-white/10 bg-black/20 p-3 text-sm",children:[e.jsx("div",{className:"font-semibold text-white",children:(Te=b==null?void 0:b.copy)==null?void 0:Te.headline}),e.jsx("p",{className:"mt-1 text-white/70",children:(Re=b==null?void 0:b.copy)==null?void 0:Re.body}),e.jsx(w,{variant:"subtle",className:"mt-3",onClick:()=>{var s,o;const t=`${(s=b==null?void 0:b.copy)==null?void 0:s.headline}

${(o=b==null?void 0:b.copy)==null?void 0:o.body}`;navigator.clipboard.writeText(t),q(r("Copy text ready to paste","Ð¢ÐµÐºÑÑ‚ÑŠÑ‚ Ðµ ÐºÐ¾Ð¿Ð¸Ñ€Ð°Ð½"))},children:r("Copy text","ÐšÐ¾Ð¿Ð¸Ñ€Ð°Ð¹ Ñ‚ÐµÐºÑÑ‚Ð°")})]})]})]}),e.jsxs("div",{className:"rounded-xl border border-white/10 bg-black/25 p-3",children:[e.jsx("iframe",{ref:pe,title:"snippet-preview",sandbox:"allow-scripts allow-forms allow-same-origin",style:{width:"100%",height:((Ue=b==null?void 0:b.attrs)==null?void 0:Ue.height)||"520px",border:"0",borderRadius:"12px",background:((Le=b==null?void 0:b.preview)==null?void 0:Le.bg)||"#0b1120"}}),e.jsx("p",{className:"mt-2 text-xs text-white/60",children:r("Preview updates automatically. Paste the snippet anywhere on your site to launch the widget.","ÐŸÑ€ÐµÐ³Ð»ÐµÐ´ÑŠÑ‚ ÑÐµ Ð¾Ð±Ð½Ð¾Ð²ÑÐ²Ð° Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡Ð½Ð¾. ÐŸÐ¾ÑÑ‚Ð°Ð²ÐµÑ‚Ðµ ÐºÐ¾Ð´Ð° Ð½Ð° ÑÐ°Ð¹Ñ‚Ð° ÑÐ¸, Ð·Ð° Ð´Ð° ÑÑ‚Ð°Ñ€Ñ‚Ð¸Ñ€Ð°Ñ‚Ðµ Ð²Ð¸Ð´Ð¶ÐµÑ‚Ð°.")})]})]})}),e.jsxs(X,{title:"Usage",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[e.jsx(R,{value:Z,onChange:t=>{be(t.target.value),ce(t.target.value)},children:c.map(t=>e.jsx("option",{value:t.id,children:t.id},t.id))}),e.jsx(w,{variant:"subtle",onClick:()=>ce(Z),disabled:!Z||je,children:je?"Loadingâ€¦":"Refresh"})]}),we.filter(t=>t&&t.event==="client_render").length===0?e.jsx("div",{className:"text-sm text-white/70",children:"No events yet."}):e.jsx("ul",{className:"space-y-1 text-xs",children:[...we].filter(t=>t&&t.event==="client_render").sort((t,s)=>((s==null?void 0:s.ts)||0)-((t==null?void 0:t.ts)||0)).map(t=>e.jsxs("li",{className:"rounded border border-white/10 bg-black/20 p-2",children:[e.jsx("span",{className:"opacity-80",children:"render"})," Â· ",e.jsx("span",{className:"opacity-60",children:new Date(t.ts).toLocaleString(void 0,{timeZoneName:"short"})})]},t.id||t.ts))})]}),e.jsxs(X,{title:"Stats & Usage",children:[e.jsx("div",{className:"mb-3 flex items-center gap-2",children:e.jsx(w,{variant:"subtle",onClick:Ee,disabled:ke,children:ke?"Loadingâ€¦":"Refresh stats"})}),x?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-4 lg:grid-cols-6",children:[e.jsxs("div",{className:"rounded-md border border-white/10 bg-black/20 p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-semibold",children:((Ae=x==null?void 0:x.totals)==null?void 0:Ae.overall)??0}),e.jsx("div",{className:"text-xs opacity-70",children:"Generations"})]}),e.jsxs("div",{className:"rounded-md border border-white/10 bg-black/20 p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-semibold",children:((De=x==null?void 0:x.last24h)==null?void 0:De.overall)??0}),e.jsx("div",{className:"text-xs opacity-70",children:"Generations (24h)"})]}),e.jsxs("div",{className:"rounded-md border border-white/10 bg-black/20 p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-semibold",children:((Ie=x==null?void 0:x.clientTotals)==null?void 0:Ie.overall)??0}),e.jsx("div",{className:"text-xs opacity-70",children:"Client renders"})]}),e.jsxs("div",{className:"rounded-md border border-white/10 bg-black/20 p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-semibold",children:((Me=x==null?void 0:x.clientLast24h)==null?void 0:Me.overall)??0}),e.jsx("div",{className:"text-xs opacity-70",children:"Client renders (24h)"})]}),e.jsxs("div",{className:"rounded-md border border-white/10 bg-black/20 p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-semibold",children:((Oe=x==null?void 0:x.plan)==null?void 0:Oe.monthlyGenerations)??0}),e.jsx("div",{className:"text-xs opacity-70",children:"Plan gens / mo"})]}),e.jsxs("div",{className:"rounded-md border border-white/10 bg-black/20 p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-semibold",children:(x==null?void 0:x.monthlyUsed)??0}),e.jsx("div",{className:"text-xs opacity-70",children:"Used this month"})]})]}),e.jsx("div",{className:"mt-4 rounded-md border border-white/10 bg-black/30 p-3",children:(()=>{var h;const t=Number((x==null?void 0:x.monthlyUsed)||0),s=Number(((h=x==null?void 0:x.plan)==null?void 0:h.monthlyGenerations)||0)+Number((x==null?void 0:x.monthlyBonus)||0),o=s>0?Math.min(100,Math.round(t/s*100)):0;return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-1 flex items-center justify-between text-xs",children:[e.jsx("div",{className:"opacity-80",children:"Monthly generations"}),e.jsxs("div",{className:"opacity-70",children:[t," / ",s," ",x!=null&&x.monthlyBonus?`(+${x.monthlyBonus} bonus)`:""]})]}),e.jsx("div",{className:"h-2 w-full overflow-hidden rounded bg-white/10",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-violet-500 via-pink-500 to-cyan-400",style:{width:o+"%"}})}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center justify-between text-xs",children:[e.jsx("div",{className:"opacity-70",children:"$10 per extra 100 gens after limit"}),e.jsx(w,{className:"px-3 py-1",onClick:async()=>{if(window.__topupBusy)return;window.__topupBusy=!0;const u=event==null?void 0:event.currentTarget;u&&(u.disabled=!0);try{const k=await fetch("/api/billing/topup",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({units:1})}),T=await k.json();if(!k.ok)throw new Error((T==null?void 0:T.error)||"Top-up failed");T!=null&&T.url&&(window.location.href=T.url)}catch(z){alert(z.message||"Top-up failed")}finally{window.__topupBusy=!1,u&&(u.disabled=!1)}},children:"Buy top-up"})]})]})})()})]}):e.jsx("div",{className:"text-sm text-white/70",children:"No stats yet."})]}),e.jsxs(X,{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:r("Troubleshooting & Help","ÐžÑ‚ÑÑ‚Ñ€Ð°Ð½ÑÐ²Ð°Ð½Ðµ Ð½Ð° Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð¸ Ð¸ Ð¿Ð¾Ð¼Ð¾Ñ‰")}),e.jsx("p",{className:"mt-2 text-sm text-white/60",children:r("Having issues? Quick fixes and diagnostic tips.","Ð˜Ð¼Ð°Ñ‚Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð¸? Ð‘ÑŠÑ€Ð·Ð¸ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ Ð¸ ÑÑŠÐ²ÐµÑ‚Ð¸ Ð·Ð° Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ°.")}),e.jsxs("div",{className:"mt-6 grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[e.jsxs("h3",{className:"flex items-center gap-2 font-medium text-white",children:[e.jsx("span",{children:"ðŸš«"}),r("Widget Not Showing","Widget Ð½Ðµ ÑÐµ Ð¿Ð¾ÐºÐ°Ð·Ð²Ð°")]}),e.jsxs("ul",{className:"mt-3 space-y-2 text-xs text-white/70",children:[e.jsxs("li",{children:["â€¢ ",r("Check browser console (F12) for errors","ÐŸÑ€Ð¾Ð²ÐµÑ€ÐµÑ‚Ðµ Ð±Ñ€Ð°ÑƒÐ·ÑŠÑ€ ÐºÐ¾Ð½Ð·Ð¾Ð»Ð°Ñ‚Ð° (F12) Ð·Ð° Ð³Ñ€ÐµÑˆÐºÐ¸")]}),e.jsxs("li",{children:["â€¢ ",r("Try hard refresh (Ctrl+F5 / Cmd+Shift+R)","ÐÐ°Ð¿Ñ€Ð°Ð²ÐµÑ‚Ðµ hard refresh (Ctrl+F5 / Cmd+Shift+R)")]}),e.jsxs("li",{children:["â€¢ ",r('CSP blocking? Use data-variant="card"','CSP Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð°? ÐŸÐ¾Ð»Ð·Ð²Ð°Ð¹Ñ‚Ðµ data-variant="card"')]})]})]}),e.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[e.jsxs("h3",{className:"flex items-center gap-2 font-medium text-white",children:[e.jsx("span",{children:"ðŸ“¤"}),r("Upload Failing","ÐšÐ°Ñ‡Ð²Ð°Ð½ÐµÑ‚Ð¾ ÑÐµ Ð¿Ñ€Ð¾Ð²Ð°Ð»Ñ")]}),e.jsxs("ul",{className:"mt-3 space-y-2 text-xs text-white/70",children:[e.jsxs("li",{children:["â€¢ ",r("Photos over 5MB are auto-compressed","Ð¡Ð½Ð¸Ð¼ÐºÐ¸ Ð½Ð°Ð´ 5MB ÑÐµ ÐºÐ¾Ð¼Ð¿Ñ€ÐµÑÐ¸Ñ€Ð°Ñ‚ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡Ð½Ð¾")]}),e.jsxs("li",{children:["â€¢ ",r("iPhone photos? Automatically optimized","iPhone ÑÐ½Ð¸Ð¼ÐºÐ¸? ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡Ð½Ð° Ð¾Ð¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ")]}),e.jsxs("li",{children:["â€¢ ",r("Supported: JPG, PNG, WEBP, HEIC","ÐŸÐ¾Ð´Ð´ÑŠÑ€Ð¶Ð°Ð½Ð¸: JPG, PNG, WEBP, HEIC")]}),e.jsxs("li",{children:["â€¢ ",r("Network timeout? Check connection","ÐœÑ€ÐµÐ¶Ð¾Ð² timeout? ÐŸÑ€Ð¾Ð²ÐµÑ€ÐµÑ‚Ðµ Ð²Ñ€ÑŠÐ·ÐºÐ°Ñ‚Ð°")]})]})]}),e.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[e.jsxs("h3",{className:"flex items-center gap-2 font-medium text-white",children:[e.jsx("span",{children:"âš¡"}),r("Generation Failing","Ð“ÐµÐ½ÐµÑ€Ð¸Ñ€Ð°Ð½ÐµÑ‚Ð¾ ÑÐµ Ð¿Ñ€Ð¾Ð²Ð°Ð»Ñ")]}),e.jsxs("ul",{className:"mt-3 space-y-2 text-xs text-white/70",children:[e.jsxs("li",{children:["â€¢ ",r("Quota reached? Upgrade or buy top-up","Ð›Ð¸Ð¼Ð¸Ñ‚? ÐªÐ¿Ð³Ñ€ÐµÐ¹Ð´Ð½ÐµÑ‚Ðµ Ð¸Ð»Ð¸ ÐºÑƒÐ¿ÐµÑ‚Ðµ Ñ‚Ð¾Ð¿-ÑŠÐ¿")]}),e.jsxs("li",{children:["â€¢ ",r("Use well-lit, high-res photos","ÐŸÐ¾Ð»Ð·Ð²Ð°Ð¹Ñ‚Ðµ Ð´Ð¾Ð±Ñ€Ðµ Ð¾ÑÐ²ÐµÑ‚ÐµÐ½Ð¸ ÑÐ½Ð¸Ð¼ÐºÐ¸")]}),e.jsxs("li",{children:["â€¢ ",r("Wait 30 seconds and retry","Ð˜Ð·Ñ‡Ð°ÐºÐ°Ð¹Ñ‚Ðµ 30 ÑÐµÐºÑƒÐ½Ð´Ð¸ Ð¸ Ð¾Ð¿Ð¸Ñ‚Ð°Ð¹Ñ‚Ðµ Ð¿Ð°Ðº")]})]})]}),e.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[e.jsxs("h3",{className:"flex items-center gap-2 font-medium text-white",children:[e.jsx("span",{children:"ðŸ›"}),r("Debug Checklist","Ð§ÐµÐºÐ»Ð¸ÑÑ‚ Ð·Ð° Ð¾Ñ‚ÑÑ‚Ñ€Ð°Ð½ÑÐ²Ð°Ð½Ðµ")]}),e.jsxs("ul",{className:"mt-3 space-y-2 text-xs text-white/70",children:[e.jsxs("li",{children:["â€¢ ",r("Open DevTools (F12) â†’ Console + Network","ÐžÑ‚Ð²Ð¾Ñ€ÐµÑ‚Ðµ DevTools (F12) â†’ Console + Network")]}),e.jsxs("li",{children:["â€¢ ",r("Verify embed ID is correct","ÐŸÑ€Ð¾Ð²ÐµÑ€ÐµÑ‚Ðµ Ð´Ð°Ð»Ð¸ embed ID Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÐµÐ½")]}),e.jsxs("li",{children:["â€¢ ",r("Try different browser (Chrome)","ÐžÐ¿Ð¸Ñ‚Ð°Ð¹Ñ‚Ðµ Ñ€Ð°Ð·Ð»Ð¸Ñ‡ÐµÐ½ Ð±Ñ€Ð°ÑƒÐ·ÑŠÑ€ (Chrome)")]})]})]})]}),e.jsxs("div",{className:"mt-4 rounded-xl border border-emerald-500/30 bg-emerald-500/10 p-4",children:[e.jsx("h3",{className:"font-medium text-emerald-400",children:r("ðŸ’¡ Need More Help?","ðŸ’¡ ÐÑƒÐ¶Ð´Ð° Ð¾Ñ‚ Ð¿Ð¾Ð²ÐµÑ‡Ðµ Ð¿Ð¾Ð¼Ð¾Ñ‰?")}),e.jsxs("p",{className:"mt-2 text-sm text-white/70",children:[r("Visit our","ÐŸÐ¾ÑÐµÑ‚ÐµÑ‚Ðµ Ð½Ð°ÑˆÐ°Ñ‚Ð°")," ",e.jsx("a",{href:"/app/docs.html#troubleshooting",className:"text-emerald-400 underline",target:"_blank",rel:"noopener noreferrer",children:r("comprehensive troubleshooting guide","Ñ†ÑÐ»Ð¾ÑÑ‚Ð½Ð° Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Ð·Ð° Ð¾Ñ‚ÑÑ‚Ñ€Ð°Ð½ÑÐ²Ð°Ð½Ðµ")})," ",r("or contact support at","Ð¸Ð»Ð¸ ÑÐµ ÑÐ²ÑŠÑ€Ð¶ÐµÑ‚Ðµ Ñ Ð¿Ð¾Ð´Ð´Ñ€ÑŠÐ¶ÐºÐ°Ñ‚Ð° Ð½Ð°")," ",e.jsx("a",{href:"mailto:bojodanchev@gmail.com",className:"text-emerald-400 underline",children:"bojodanchev@gmail.com"})]}),e.jsx("p",{className:"mt-3 text-xs text-white/60",children:r("Please include: browser console screenshot, embed ID, and steps to reproduce.","ÐœÐ¾Ð»Ñ Ð²ÐºÐ»ÑŽÑ‡ÐµÑ‚Ðµ: ÑÐºÑ€Ð¸Ð¹Ð½ÑˆÐ¾Ñ‚ Ð½Ð° Ð±Ñ€Ð°ÑƒÐ·ÑŠÑ€ ÐºÐ¾Ð½Ð·Ð¾Ð»Ð°Ñ‚Ð°, embed ID Ð¸ ÑÑ‚ÑŠÐ¿ÐºÐ¸ Ð·Ð° Ð²ÑŠÐ·Ð¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ¶Ð´Ð°Ð½Ðµ.")})]})]})]}),e.jsx(mt,{open:oe,step:qe,placement:Ce,snippet:J,onClose:()=>{de(!1),se(1)},onCopy:$e,onNext:()=>se(t=>Math.min(3,t+1)),onPrev:()=>se(t=>Math.max(1,t-1)),onPlacement:Pe,onPreview:Ke,t:r})]})}function We(){const[a,i]=pt();if(!a)return e.jsx(ut,{});const m=async()=>{try{await fetch("/api/client/me?action=logout",{method:"POST",headers:{Authorization:`Bearer ${a}`}})}catch{}i(""),window.location.href="/app/client.html"};return e.jsx(gt,{token:a,onSignOut:m})}class He extends Je.Component{constructor(i){super(i),this.state={hasError:!1,message:""}}static getDerivedStateFromError(i){return{hasError:!0,message:(i==null?void 0:i.message)||""}}componentDidCatch(i,m){try{console.error("Client portal error",i,m)}catch{}}render(){return this.state.hasError?e.jsxs("div",{className:"p-6 text-red-400",children:["Failed to load portal. Please hard refresh. ",this.state.message?`(${this.state.message})`:""]}):this.props.children}}const xe=()=>{const a=document.getElementById("root");a&&(at&&typeof _e.createRoot=="function"?_e.createRoot(a).render(e.jsx(He,{children:e.jsx(We,{})})):he&&typeof he.render=="function"&&he.render(e.jsx(He,{children:e.jsx(We,{})}),a))};document.readyState==="loading"?(document.addEventListener("DOMContentLoaded",xe,{once:!0}),setTimeout(xe,1500)):xe();(function(){if(new URLSearchParams(window.location.search).get("devtest")!=="1")return;const m=[],p=(j,C,$="")=>m.push({name:j,pass:!!C,detail:$}),c=me("abc",{attrs:{theme:"light",wide:"true",radius:"18px"}});p("snippet has script tag",/^<script\s.+><\/script>$/.test(c)),p("includes data-embed-id",c.includes('data-embed-id="abc"')),p("includes theme",c.includes('data-theme="light"')),p("includes wide toggle",c.includes('data-wide="true"'));const v=new URL(window.location.href);v.searchParams.set("token","T_URL");const y=v.searchParams.get("token")==="T_URL";p("URLSearchParams working",y),console.table(m.map(j=>({test:j.name,pass:j.pass,detail:j.detail})))})();
